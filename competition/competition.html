<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">    
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../myStyles.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed|Saira+Extra+Condensed" rel="stylesheet">
    <title>Final Competition | Team Firework</title>
  </head>

  <body>
  	<!-- Page header -->
  	<div class="page-header">
  		<div class="container-fluid">
		<h1 align="center"><span style="color:#fad5a6"><b>Team Firework</b></span></h1>
		<h3 align="center"><span style="color:#fad5a6">Final Competition</span></h3>
		</div>
		<!--<div class="container" align="center">
			<audio src="audio/firework.mp3" loop="loop" controls controlsList="nodownload"><p>Oh no! You can't hear our music.</p></audio>
		</div>-->
  	</div>

  	<!-- Navigation bar -->
  	<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <!--<div class="container-fluid">
      <a href="#"><span class="glyphicon glyphicon-star-empty"></span></a>-->
  	  </div>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="active"><a href="../index.html">Home<span class="sr-only">(current)</span></a></li>
        <li><a href="../sparky.html">Sparky</a></li>
        <li><a href="../team.html">Team</a></li>
        <li class="dropdown" class="active">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Assignments <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../lab1/lab1.html">Lab 1</a></li>
            <li><a href="../lab2/lab2.html">Lab 2</a></li>
            <li><a href="../lab3/lab3.html">Lab 3</a></li>
            <li><a href="../lab4/lab4.html">Lab 4</a></li>
            <li role="separator" class="divider"></li>
            <li><a href="../milestone1/milestone1.html">Milestone 1</a></li>
            <li><a href="../milestone2/milestone2.html">Milestone 2</a></li>
            <li><a href="../milestone3/milestone3.html">Milestone 3</a></li>
            <li><a href="../milestone4/milestone4.html">Milestone 4</a></li>
            <li role="separator" class="divider"></li>
            <li><a href="../ethics.html">Ethics HW</a></li>
            <li><a href="../competition.html">Final Competition!</a></li>
          </ul>
        </li>
        <li><a href="tutorials.html">Tutorials</a></li>
      </ul>
      <!--A search bar -->
      <!--<form class="navbar-form navbar-left">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>
      </form>-->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
    
    <!--Page content -->
    <div class="body-content">
	    <!--
    	<h1>It's All About Integration</h1>
      <p>Now that we have all the components, it's time to put them together! We assigned our pins, put our sensors on a PCB, soldered together our treasure detection circuit, implemented the DFS and........</p>
      <h3 align="center">Things Didn't Work :(</h3>
      -->
	<hr>
      	<h1>Wall Distance Sensors</h1>
      <!--
      <p>One wall sensor values were super inconsistent! The robot was detecting walls with false positives and false negatives, which throws off the maze mapping and traversal.</p>
      <p><b>Solution 1: Averaging</b><br> We try to take an average over 5 values, with a slight delay of 25 milliseconds between each reading. (Without the delay, the 5 values were too similar.) This seemed to work for a while, but was heavily affected by shadows and lighting conditions.</p>
      <p><b>Solution 2: Number of correct values</b><br> Our second solution is to take 6 values, and return a wall detected if at least 4 values detect a wall. This prevents averaging of any "spikes" in data.</p>
      -->
	<p>One major problem we keep running into is incorrect wall detection, which is caused by the inconsistency of wall distance 
		sensor value we are reading. The first solution we thought of is averaging. We created a for loop to take five 
		measurements instead of only one and used the average result to compare to the threshold. Initially, we were not 
		aware of the ~20 ms sampling interval of the IR distance sensor and we took five consecutive measurement readings, 
		which were essentially reading the same value. After consulting the IR distance sensor datasheet, we took into account 
		of the sampling interval by putting a 25 ms delay between each reading. Still, the averaging wasn’t working as good as 
		we would like mainly because the outlier value would skew the average a lot and give us incorrect detection. For example
		, when we shakes the signal wire of the wall sensor to mimic actual robot traversing, the first sample sometimes reads 
		800 (detect wall) following by 4 samples reading 30 (detect no wall) in a no wall situation. The average result is 
		about 180 and it is greater than our threshold and gives us a false wall detection, even though four out of five times 
		it correctly detects no walls. To address this, we came up with another method to detect wall by minimizing outlier 
		interference. The second solution we thought of is to take six measurements, a wall is detected only if at least four 
		out of six measurements are above the threshold. This way the outlier doesn’t interfere with other sample reads and 
		our wall detection starts to work like a charm. (Though we still need to calibrate the wall sensor threshold slightly 
		based on different lighting conditions.) Another problem that occurred in the last minute was that the IR treasures 
		could interfere with the wall sensors measurement. To address this issue, we ingeniously stacked some washers and nuts 
		under the wall sensors mount and this elevated the sensors to be higher and further away from the treasures. It 
		successfully minimized treasures interference by a great deal.</p>
	<hr>
      	<h1>Line Sensors</h1>
    <!--
      <p>At first, our line sensors were giving us very high values. There were faulty connection errors on our PCB (as the header pins were too big and our wires slipped easily), and also we had changed the position of the line sensors on the mount to prevent any values from falsely detecting an intersection when the robot tipped. When we finally settled on our final line sensor and mount design, we had to recalibrate the detection value.</p>
    -->
	<p>One lesson we learned about line sensor is its insane sensitivity: a couple mm off the floor would yield drastic difference 
		in sensor value readings, so the closer we keep the line sensor to ground the accurater our result will be. To address 
		this, we designed a new line sensor mount with three different parts that can be laser cut out and glued together. 
		This is over-engineering in hindsight as we didn’t have it cut out and use it. We came up with a way easier solution
		to keep line sensor closer to ground by stacking washer to the already provided 3D printed out mounts to push it 
		closer to ground. Before this change, our line sensors read white with values in 700 range and black in 1000 range. 
		Since the modification, our line sensors read white with values in 200 range and black in 900 range. The larger gap 
		between white and black detection enables our line sensors to detect black with a lot more accurate and almost free 
		of errors.</p>
	    <img src="Line_Sensor_Mount.png" align="center">
	    <hr>
	    
      <h1>DFS Optimization</h1>
      <p>After we have thoroughly tested the DFS, we started adding optimizations. The largest optimization is to prevent the last backtrack, where the usual DFS algorithm would return to the root of the tree (the starting node). But we wanted to do this in a method where we don't have to save the already-traversed path. So we used what we call a "root update" condition. Say we have the tree below.</p>
      <img src="dfs-rootupdate1.jpg" align="center">
      <p>The blue circles represent traversed nodes. We have gone from node 19 to 18 to 17, then back to 18 and 19. We are going to be moving to node 15 next. However, 15 is the last unexplored neighbor of 19. We don't need 19 to be the root of the tree anymore! So when we are moving to the last unexplored neighbor of the root node, then we can update our tree's root.</p>
      <img src="dfs-rootupdate2.jpg" align="center">
      <p>Similarly, in this tree, we have updated our root to 15, traversed to 15, 14, and back to 15 again. 11 is the last unexplored neighbor of the root (15). So when we go to 11, we update the root to 11. Now that 11 is the root and there are no more neighbors, we know we are done. In essence, this prevents the last backtrack in a usual DFS, where the robot would have to traverse from 11, to 15, to 19, then end.</p>
      <hr>
	    
      <h1>Treasure Detection</h1>
      <!--Ian!-->
	    <p>As the final competition approached, we focused our attention on full completion and mapping of the maze. We had 
		    our treasure circuitry set and mounted from Milestone 4, but we did not find as much time to test it as we 
		    would have liked. There also appeared to be a treasure shortage in the lab in the days leading up to the 
		    competition, which did not help our testing. A diagram of our circuit can be found in the Sparky section of 
		    this site. </p>
	    <p>Our circuit could detect treasures from about 2 inches away, so we mounted our phototransistors so that they 
		    reach out on both sides of the robot facing the wall. The issue we ran into with mounting the sensors is 
		    that they were prone to snagging on the walls during tight turns. When the sensors would get snagged, the
		    robot would get completely thrown off and forget where it is, run into walls, murder other robots, etc. 
		    Therefore, because we decided to play it safe for the final competition, we shortened the reach of the 
		    treasure sensors so that there would be no chance of it catching on the walls. Unfortunately, though, this 
		    resulted in our robot missing a few treasures during the competition. A point we are proud of for our treasure 
		    sensors is that we could detect treasures even if they are not placed at intersections due to the way we are 
		    implementing it with interrupts. Even though this did not come in too much use during the final competition, 
		    it was still pretty cool.</p>

      <hr>
	    
      <h1>Radio</h1>
      <!--Felipe!-->
	    <p>The radio and FPGA map drawing were working by milestone 4, so please watch the milestone 4 video to see it in action. 
		    The robot sends two bytes of data over radio at each intersection, one with the robot's location and orientation, 
		    and one with the wall and treasure information at that node. Data is sent even if a node has been visited before, 
		    in order to update the location of the robot, but no new wall sensor data is taken at visited nodes (though if a 
		    treasure is detected later it will be corrected). The receiving Arduino returns the same data back to the robot. 
		    If the robot doesn't receive this handshake, it resends the packet, and only continues once the data has been 
		    successfully transmitted. The receiving Arduino connects to the FPGA using SPI, and simply relays the same two 
		    bytes it received from the robot. The FPGA only receives data about one node at a time, as opposed to receiving 
		    the entire maze each time. It doesn't contain the logic to tell if the maze has been fully explored, this is done 
		    through a done signal from the robot itself, and it turns the unused parts of the screen blue instead of black, 
		    and starts up the song once it receives the done signal. </p>
	    <p>The radio on the receiving Arduino has already been using the Arduino SPI library and Arduino SPI pins (Pin 11 MOSI, Pin 12 MISO 
		    and Pin 13 CLK) to receive data. We could potentially use these pins to transmit data to the FPGA, but we decided 
		    it will be more fun writing our own bitbanging SPI protocol so we can use any pins on the Arduino to transmit data, which we did and shown below. </p>    
		<!--Code Start-->
	    <pre>
<font color="#434f54">&#47;&#47;Fireworks SPI Bitbanging Transmitting Library</font>
<font color="#00979c">int</font> <font color="#000000">SPI_cs_pin</font> <font color="#434f54">=</font> <font color="#000000">3</font><font color="#000000">;</font>
<font color="#00979c">int</font> <font color="#000000">SPI_data_pin</font> <font color="#434f54">=</font> <font color="#000000">4</font><font color="#000000">;</font>
<font color="#00979c">int</font> <font color="#000000">SPI_clock_pin</font> <font color="#434f54">=</font> <font color="#000000">5</font><font color="#000000">;</font>

<font color="#434f54">&#47;&#47;Call setupSPI in void setup(void) to initialize SPI</font>
<font color="#00979c">void</font> <font color="#000000">setupSPI</font><font color="#000000">(</font><font color="#00979c">void</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#d35400">pinMode</font><font color="#000000">(</font><font color="#000000">SPI_cs_pin</font><font color="#434f54">,</font> <font color="#00979c">OUTPUT</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">pinMode</font><font color="#000000">(</font><font color="#000000">SPI_data_pin</font><font color="#434f54">,</font> <font color="#00979c">OUTPUT</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">pinMode</font><font color="#000000">(</font><font color="#000000">SPI_clock_pin</font><font color="#434f54">,</font> <font color="#00979c">OUTPUT</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">SPI_cs_pin</font><font color="#434f54">,</font> <font color="#00979c">LOW</font><font color="#000000">)</font><font color="#000000">;</font> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;Initialize CS to be LOW</font>
 &nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">SPI_clock_pin</font><font color="#434f54">,</font> <font color="#00979c">LOW</font><font color="#000000">)</font><font color="#000000">;</font> &nbsp;&nbsp;<font color="#434f54">&#47;&#47;Initialize Clock to be LOW</font>
<font color="#000000">}</font>

<font color="#434f54">&#47;&#47;Create our SPI function to send 8 bit of data (MSB first)</font>
<font color="#00979c">void</font> <font color="#000000">sendSPI</font><font color="#000000">(</font><font color="#00979c">byte</font> <font color="#000000">data</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#434f54">&#47;&#47;Create rising edge of CS to start sending packages</font>
 &nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">SPI_cs_pin</font><font color="#434f54">,</font> <font color="#00979c">LOW</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">SPI_cs_pin</font><font color="#434f54">,</font> <font color="#00979c">HIGH</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#434f54">&#47;&#47;Send a byte of data, bit by bit, MSB first</font>
 &nbsp;<font color="#5e6d03">for</font> <font color="#000000">(</font><font color="#00979c">int</font> <font color="#5e6d03">loop</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font> <font color="#5e6d03">loop</font> <font color="#434f54">&lt;</font> <font color="#000000">8</font><font color="#000000">;</font> <font color="#5e6d03">loop</font><font color="#434f54">++</font><font color="#000000">)</font> <font color="#000000">{</font>

 &nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;If bit is high, set data pin high; if bit is low, set data pin low</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font> <font color="#434f54">!</font><font color="#434f54">!</font><font color="#000000">(</font><font color="#000000">data</font> <font color="#434f54">&amp;</font> <font color="#000000">(</font><font color="#000000">1</font> <font color="#434f54">&lt;&lt;</font> <font color="#000000">(</font><font color="#000000">7</font> <font color="#434f54">-</font> <font color="#5e6d03">loop</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">)</font> <font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">SPI_data_pin</font><font color="#434f54">,</font> <font color="#00979c">HIGH</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">else</font> <font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">SPI_data_pin</font><font color="#434f54">,</font> <font color="#00979c">LOW</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;Create rising edge of clock to indicate data is ready</font>
 &nbsp;&nbsp;&nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">SPI_clock_pin</font><font color="#434f54">,</font> <font color="#00979c">LOW</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">SPI_clock_pin</font><font color="#434f54">,</font> <font color="#00979c">HIGH</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#434f54">&#47;&#47;Create falling edge of CS to indicate finish sending packages</font>
 &nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">SPI_cs_pin</font><font color="#434f54">,</font> <font color="#00979c">LOW</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">SPI_clock_pin</font><font color="#434f54">,</font> <font color="#00979c">LOW</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#434f54">&#47;&#47;Delay 500ms</font>
 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">500</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

</pre>
	    <!--Code End-->
    <hr>
	    
      	<h1>Unit Testing</h1>
      <!--Xitang-->
	    <p>Sensor threshold value often requires calibration depending on the environment and servo motor’s stopping signal 
		    can sometimes change from 90 to 91 to 92 with frequent use. For ease of sensor calibration and debugging, 
		    we created three diagnostics code to perform individual unit testing for line sensor, wall sensor and servo motor.  </p>
	    //Code
	    <p>Line Sensor Diagnostics/Caliberation Code</p>
	    <!--Code Start-->
	    <pre>
<font color="#434f54">&#47;&#47;Fireworks Line Sensor Diagnostics&#47;Caliberation Code</font>
<font color="#00979c">int</font> <font color="#000000">lineMidLeft</font><font color="#434f54">,</font> <font color="#000000">lineMidRight</font><font color="#434f54">,</font> <font color="#000000">lineRight</font><font color="#434f54">,</font> <font color="#000000">lineLeft</font><font color="#000000">;</font> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;Line Sensor Values Variables</font>
<font color="#00979c">int</font> <font color="#000000">lineMidLeftPin</font><font color="#434f54">,</font> <font color="#000000">lineMidRightPin</font><font color="#434f54">,</font> <font color="#000000">lineRightPin</font><font color="#434f54">,</font> <font color="#000000">lineLeftPin</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47; Analog pins with line sensors</font>
<font color="#00979c">int</font> <font color="#000000">blackDetect</font> <font color="#434f54">=</font> <font color="#000000">600</font><font color="#000000">;</font> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47; Threshold above which sensors are reading a black line</font>

<font color="#00979c">void</font> <font color="#000000">printSensors</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#000000">lineLeft</font> <font color="#434f54">=</font> <font color="#d35400">analogRead</font><font color="#000000">(</font><font color="#000000">lineLeftPin</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">lineMidLeft</font> <font color="#434f54">=</font> <font color="#d35400">analogRead</font><font color="#000000">(</font><font color="#000000">lineMidLeftPin</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">lineMidRight</font> <font color="#434f54">=</font> <font color="#d35400">analogRead</font><font color="#000000">(</font><font color="#000000">lineMidRightPin</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">lineRight</font> <font color="#434f54">=</font> <font color="#d35400">analogRead</font><font color="#000000">(</font><font color="#000000">lineRightPin</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#000000">lineLeft</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34; &nbsp;&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#000000">lineMidLeft</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34; &nbsp;&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#000000">lineMidRight</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34; &nbsp;&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#000000">lineRight</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34; &nbsp;&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#5e6d03">setup</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">begin</font><font color="#000000">(</font><font color="#000000">9600</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">lineLeftPin</font> <font color="#434f54">=</font> <font color="#000000">A0</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">lineMidLeftPin</font> <font color="#434f54">=</font> <font color="#000000">A1</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">lineMidRightPin</font> <font color="#434f54">=</font> <font color="#000000">A2</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">lineRightPin</font> <font color="#434f54">=</font> <font color="#000000">A3</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#5e6d03">loop</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#000000">printSensors</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

</pre>
	    <!--Code End-->
	    <p>Wall Distance Sensor Diagnostics Code</p>
	    <!--Code Start-->
	    <pre>
<font color="#434f54">&#47;&#47;Fireworks Wall Distance Sensor Diagnostics&#47;Caliberation</font>
<font color="#00979c">int</font> <font color="#000000">mux_S0</font> <font color="#434f54">=</font> <font color="#000000">7</font><font color="#434f54">,</font> <font color="#000000">mux_S1</font> <font color="#434f54">=</font> <font color="#000000">8</font><font color="#000000">;</font>
<font color="#00979c">int</font> <font color="#000000">distanceInput</font><font color="#000000">;</font>

<font color="#00979c">int</font> <font color="#000000">isThereAWall</font><font color="#000000">(</font><font color="#00979c">int</font><font color="#000000">)</font><font color="#000000">;</font>

<font color="#00979c">void</font> <font color="#5e6d03">setup</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">begin</font><font color="#000000">(</font><font color="#000000">9600</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">pinMode</font><font color="#000000">(</font><font color="#000000">mux_S0</font><font color="#434f54">,</font> <font color="#00979c">OUTPUT</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">pinMode</font><font color="#000000">(</font><font color="#000000">mux_S1</font><font color="#434f54">,</font> <font color="#00979c">OUTPUT</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">distanceInput</font> <font color="#434f54">=</font> <font color="#000000">A4</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#5e6d03">loop</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">isThereAWall</font><font color="#000000">(</font><font color="#000000">0</font><font color="#000000">)</font> <font color="#434f54">==</font> <font color="#000000">1</font><font color="#000000">)</font> <b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Leftwall detected&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">isThereAWall</font><font color="#000000">(</font><font color="#000000">1</font><font color="#000000">)</font> <font color="#434f54">==</font> <font color="#000000">1</font><font color="#000000">)</font> <b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Front wall detected&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">isThereAWall</font><font color="#000000">(</font><font color="#000000">2</font><font color="#000000">)</font> <font color="#434f54">==</font> <font color="#000000">1</font><font color="#000000">)</font> <b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Right wall detected&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">2000</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">int</font> <font color="#000000">isThereAWall</font> <font color="#000000">(</font><font color="#00979c">int</font> <font color="#000000">sensor</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#00979c">int</font> <font color="#000000">wallDetectCounter</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">int</font> <font color="#000000">temp</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">sensor</font> <font color="#434f54">==</font> <font color="#000000">0</font><font color="#000000">)</font> <font color="#000000">{</font> <font color="#434f54">&#47;&#47;Y0 - left wall; S0 = 0, S1 = 0</font>
 &nbsp;&nbsp;&nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">mux_S0</font><font color="#434f54">,</font> <font color="#00979c">LOW</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">mux_S1</font><font color="#434f54">,</font> <font color="#00979c">LOW</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">for</font> <font color="#000000">(</font><font color="#00979c">int</font> <font color="#000000">i</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font> <font color="#000000">i</font> <font color="#434f54">&lt;</font> <font color="#000000">6</font><font color="#000000">;</font> <font color="#000000">i</font><font color="#434f54">++</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">temp</font> <font color="#434f54">=</font> <font color="#000000">temp</font> <font color="#434f54">+</font> <font color="#d35400">analogRead</font><font color="#000000">(</font><font color="#000000">distanceInput</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;Calculate average value</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;Increase wall detect counter by 1 if greater than threshold</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">analogRead</font><font color="#000000">(</font><font color="#000000">distanceInput</font><font color="#000000">)</font> <font color="#434f54">&gt;</font> <font color="#000000">270</font><font color="#000000">)</font> <font color="#000000">wallDetectCounter</font><font color="#434f54">++</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">25</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;Wait for next IR sample</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;Left wall avg value:&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#5e6d03">else</font> <font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">sensor</font> <font color="#434f54">==</font> <font color="#000000">1</font><font color="#000000">)</font> <font color="#000000">{</font> <font color="#434f54">&#47;&#47;Y1 - front wall; S0 = 1, S1 = 0</font>
 &nbsp;&nbsp;&nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">mux_S0</font><font color="#434f54">,</font> <font color="#00979c">HIGH</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">mux_S1</font><font color="#434f54">,</font> <font color="#00979c">LOW</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">for</font> <font color="#000000">(</font><font color="#00979c">int</font> <font color="#000000">i</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font> <font color="#000000">i</font> <font color="#434f54">&lt;</font> <font color="#000000">6</font><font color="#000000">;</font> <font color="#000000">i</font><font color="#434f54">++</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">temp</font> <font color="#434f54">=</font> <font color="#000000">temp</font> <font color="#434f54">+</font> <font color="#d35400">analogRead</font><font color="#000000">(</font><font color="#000000">distanceInput</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">analogRead</font><font color="#000000">(</font><font color="#000000">distanceInput</font><font color="#000000">)</font> <font color="#434f54">&gt;</font> <font color="#000000">100</font><font color="#000000">)</font> <font color="#000000">wallDetectCounter</font><font color="#434f54">++</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">25</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;Front wall avg value:&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#5e6d03">else</font> <font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">sensor</font> <font color="#434f54">==</font> <font color="#000000">2</font><font color="#000000">)</font> <font color="#000000">{</font> <font color="#434f54">&#47;&#47;Y2 - right wall; S0 = 0, S1 = 1</font>
 &nbsp;&nbsp;&nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">mux_S0</font><font color="#434f54">,</font> <font color="#00979c">LOW</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">mux_S1</font><font color="#434f54">,</font> <font color="#00979c">HIGH</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">for</font> <font color="#000000">(</font><font color="#00979c">int</font> <font color="#000000">i</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font> <font color="#000000">i</font> <font color="#434f54">&lt;</font> <font color="#000000">6</font><font color="#000000">;</font> <font color="#000000">i</font><font color="#434f54">++</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">temp</font> <font color="#434f54">=</font> <font color="#000000">temp</font> <font color="#434f54">+</font> <font color="#d35400">analogRead</font><font color="#000000">(</font><font color="#000000">distanceInput</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">analogRead</font><font color="#000000">(</font><font color="#000000">distanceInput</font><font color="#000000">)</font> <font color="#434f54">&gt;</font> <font color="#000000">270</font><font color="#000000">)</font> <font color="#000000">wallDetectCounter</font><font color="#434f54">++</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">25</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;Right wall avg value:&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#000000">temp</font> <font color="#434f54">=</font> <font color="#000000">temp</font> <font color="#434f54">&#47;</font> <font color="#000000">5</font><font color="#000000">;</font> <b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">temp</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;Print average value</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;Number of Wall Count:&#34;</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;Print # of wall count</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">wallDetectCounter</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#434f54">&#47;&#47;If at least 4 out of 6 wall detected, return 1 - wall detected</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">wallDetectCounter</font> <font color="#434f54">&gt;=</font> <font color="#000000">4</font><font color="#000000">)</font> <font color="#5e6d03">return</font> <font color="#000000">1</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">else</font> <font color="#5e6d03">return</font> <font color="#000000">0</font><font color="#000000">;</font>
<font color="#000000">}</font>

</pre>
	    <!--Code End-->
	    <p>Servo Motor Diagnostics/Caliberation Code</p>
		    <pre>
<font color="#434f54">&#47;&#47;Fireworks Servo Motor Diagnostics&#47;Caliberation Code</font>
<font color="#5e6d03">#include</font> <font color="#434f54">&lt;</font><b><font color="#d35400">Servo</font></b><font color="#434f54">.</font><font color="#000000">h</font><font color="#434f54">&gt;</font>
<b><font color="#d35400">Servo</font></b> <font color="#000000">leftWheel</font><font color="#434f54">,</font> <font color="#000000">rightWheel</font><font color="#000000">;</font>
<font color="#00979c">int</font> <font color="#000000">leftWheelPin</font> <font color="#434f54">=</font> <font color="#000000">5</font><font color="#000000">;</font>
<font color="#00979c">int</font> <font color="#000000">rightWheelPin</font> <font color="#434f54">=</font> <font color="#000000">6</font><font color="#000000">;</font>

<font color="#00979c">void</font> <font color="#5e6d03">setup</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#000000">leftWheel</font><font color="#434f54">.</font><font color="#d35400">attach</font><font color="#000000">(</font><font color="#000000">leftWheelPin</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">rightWheel</font><font color="#434f54">.</font><font color="#d35400">attach</font><font color="#000000">(</font><font color="#000000">rightWheelPin</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">leftWheel</font><font color="#434f54">.</font><font color="#d35400">write</font><font color="#000000">(</font><font color="#000000">91</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">rightWheel</font><font color="#434f54">.</font><font color="#d35400">write</font><font color="#000000">(</font><font color="#000000">90</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>
</pre>
    </div>

    <!-- Footer -->
    <div id="footer">
      <div class="container">
        <p class="muted credit" align="center">Brought to you by Team Firework. Have an explosive day!</p>
      </div>
    </div>

    <!-- Bootstrap core JavaScript -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>


  </body>

</html>
